enhanced 3D bounding box implementation