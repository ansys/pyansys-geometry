trapezoid signature change and internal checks